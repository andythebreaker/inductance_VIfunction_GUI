# inductance_VIfunction_GUI
Analyze the current versus voltage function with a graphical user interface for inductors in direct current

![](https://i.imgur.com/B2eldZj.jpg)

Based on the above engineering mathematical calculations, we can know the relationship between current and voltage in the circuit of series inductance. We hope that software can be used to simulate such a phenomenon, but because the calculation at that time assumed that the voltage was a constant value, and the boundary value problem was solved. The above-mentioned over-ideal assumption leads to voltage not being a function of time, and the simulated result will be distorted. After all, our goal is to control the magnetic force of the electromagnet (that is, simplified: the value of the current flowing through the inductor), so we will see the voltage as a function of time, and recalculate the current-to-voltage function.

Have ODE

$$V=L\frac{dI}{dt}+IR$$

solve the linear equation

$$y(t)=a\frac{dx(t)}{d(t)}+bx(t)$$

where constant is defined as $a=L;\ b=R;$

subtract $bx(t)+y(t)+ax'(t)$ from both sides and divide by $-a$

$$\frac{dx(t)}{d(t)}+\frac{bx(t)}{a}=\frac{y(t)}{a}$$

let 

$$\mu(t)=e^{\int \frac{b}{a} dt}=e^{\frac{bt}{a}}$$

multiply by both sides by $\mu(t)$

$$e^{\frac{bt}{a}}\frac{dx(t)}{d(t)}+\frac{(be^{\frac{bt}{a}})x(t)}{a}=\frac{e^{\frac{bt}{a}}y(t)}{a}$$

substitute 

$\frac{be^{\frac{bt}{a}}}{a}=\frac{d}{dt}e^{\frac{bt}{a}}$

$$e^{\frac{bt}{a}}\frac{dx(t)}{dt}+\frac{d}{dt}e^{\frac{bt}{a}}x(t)=\frac{e^{\frac{bt}{a}}y(t)}{a}$$

apply the reverse product rule $f\frac{dg}{dt}+g\frac{df}{dt}=\frac{d}{dt}(fg)$ to the left-hand side

$$\frac{d}{dt}e^{\frac{bt}{a}}x(t)=\frac{e^{\frac{bt}{a}}y(t)}{a}$$

integrate both side with respect to $t$

$$\int \frac{d}{dt}\ e^{\frac{bt}{a}}x(t)\ dt=\int\frac{e^{\frac{bt}{a}}y(t)}{a}\ dt$$

evaluate the integrals

$$e^{\frac{bt}{a}}x(t)=\frac{1}{a}\int e^{\frac{bt}{a}}y(t)\ dt+c_1$$

divide both side by $\mu=e^{\frac{bt}{a}}$

$$x(t)=e^{\frac{-bt}{a}}\frac{1}{a}\int e^{\frac{bt}{a}}y(t)\ dt+c_1$$

ODE solved

### matlab code

#### Introduction

Assuming a circuit, which has three components, as follows: inductor, inductor internal resistance, variable DC voltage source. By connecting the three components in series, the user can change the voltage value of the variable DC voltage source by using the graphical user interface, and watch the current change in the circuit, the voltage change on the inductor, and the voltage change of the input power supply. The above-mentioned values are presented in real time using a table and are all functions of time.

#### Download code

Since the GUI is used in the program, we provide a hyperlink to the repository on github for everyone to download the program.
The code of the main logic part of this program will be attached to the last page of this document for your reference, but please do not directly take the code to MATLAB for execution, because of the lack of UI components, errors will occur during the compilation of the program.

[https://github.com/andythebreaker/inductance_VIfunction_GUI](https://github.com/andythebreaker/inductance_VIfunction_GUI)

#### Run the code

This program is developed and tested using matlab 2018 b, and the environment is windows10.

1. Unzip the downloaded code to a local folder, add the folder path to the matlab environment and change the current directory to this folder.
2. Use matlab editor to open `m` file.
3. Run the program (F5).
4. You will see a window program with two tables and some buttons.

#### Operation interface introduction

![](https://i.imgur.com/rcKSz2w.png)

First, you can see that there are two charts in the interface. The table on the left is a graph of current versus time, where the unit of current is Ampere. Moreover, the horizontal axis of this table is time and its unit is seconds multiplied by the sampling rate. On the other hand, the vertical axis of this table indicates the current in the circuit loop.

On the other side, the right-table has two data lines, where the orange data line is the input voltage and the blue data line is the inductor voltage. These values are generated by the following methods: The input voltage is controlled by the user and the orange inductor voltage is calculated by our engineering mathematical formula. Although we have different units on the y-axis, the horizontal axis of this table means time and its unit is seconds multiplied by the sampling rate.

If you have doubts about the meaning of the data line, you can refer to the text descriptions in both tables.

Next, we will explain the function of each button.
There is a button at the top of the form with the word “initialization” written on it and three buttons at the top right of the operation interface that is written as "clear",  "start", and "stop", respectively. We will tell you how to operate these buttons in the following chapters.

There are two input fields labeled `L` and `R` on the right side of the operation interface. These two input fields respectively represent the value of inductance (Unit: Henry) and resistance (Unit: Ohm) in the circuit. 

If we continue to look down, we can see that there are two additional input fields, namely "the sampling rate" and "the maximum amount of data that can be accommodated on the horizontal axis of the table".Because the amount of data that a chart can present is limited, we use a number to limit the maximum time that a chart can display on the horizontal axis, which is the latter edit text box. For the previous one, you can use the following logic to think about it: Since there is an integral in the engineering mathematical equations we have obtained, we use a discrete way to integrate it with time, so we need a variable to determine the resolution of time.

Just a reminder, you can see the two sets of explanatory text and numbers which are the current value of current and the PWM control cycle in the southeast of the entire interface. These two values will be discussed in a future chapter.

Finally, we see that there are two slide rails at the bottom of the user interface that represent the current input voltage (users can adjust the input voltage by moving this slide rail)and PWM ratio. The UI element "current input voltage" has a minimum value of 0 and the maximum value is 50. Units in volts.

Any components not mentioned in this chapter will be explained in future chapters.

#### Method of operation

1. Start the simulation program.
2. Press the clear button.
3. Press the initialization button.
4. Adjust the value of R and L, you can enter decimals and integers. (illegal values will cause a warning window)
> The suggested value has been preset in the interface, no need to change the value to get a reasonable graph.
5. Press the start button.
6. Drag the slider that represents the input voltage as you like.
7. Observe the data changes in the chart.
8. Press the stop button.

#### Results and discussion

![](https://i.imgur.com/S8mYHDl.png)

Through the presentation of the graph, we can easily find that there is a step function of the input voltage near time equal to 0. This step function causes the current to rise in a natural exponential manner, and the cross voltage on the inductance decline in the form of a natural exponential right after a sudden rise.

By changing the input voltage, we can observe the current change with voltage from the graph. In this way, we have an understanding of the significant impact on the actual engineering of the first-order differential equation.

Since the initial goal of this topic is to consider how the current will be changed when the voltage continues to fluctuate. In the digital world and DC, PWM control is obviously the easiest DC control method, which makes us very curious what kind of current output we can get if we pass the PWM DC signal to the target inductor.

## PWM控制

### 操作方式

Since we already know the time constant of a series inductance through the previous engineering mathematics derivation, we only consider the situation where the time period of the high potential of the PWM signal is less than the time constant.

1. Start the simulation program.
2. Press the clear button.
3. Press the initialization button.
4. Adjust the value of R and L, you can enter decimals and integers. (illegal values will cause a warning window)
> The suggested value has been preset in the interface, no need to change the value to get a reasonable graph.
5. Set the output voltage to about 5 volts.
6. Set the pwm signal ratio to about half of the position.
7. Tick the check box "using pwm signal".
8. Press the start button.
9. Observe the data changes in the chart.
10. Press the stop button.

### 模擬實驗結果

![](https://i.imgur.com/yYrJgi0.png)

We can see that when the automatic PWM assist is turned on, the input voltage slider will automatically oscillate in a square wave form between 5 volts and 45 volts, and the high potential time ratio can be controlled by the user (lower right corner).

Through such experimental simulation results, we can easily find that if we want to control an inductance (electromagnet) with higher sensitivity, using direct current is not necessarily the best way. Because when the control voltage rises or falls, it takes a period of time before the current on the inductor can reflect to the target position, which is definitely not what we want in any control situation.

### 已知限制

In our discrete mathematical simulation, there is an integral item that causes the variable to exceed the "double" range and cause the program to terminate. We can observe the real-time current value to know when the program will stop because due to too-large data. When the real-time current value reaches infinity, the program will automatically stop.

### 已知缺陷

After about 3 to 5 seconds after the program is executed, a memory out-of-range error will occur due to improper memory management and cause the entire program to crash. However, this error has not been corrected in this version of the program because all simulations can be done within 3~5 seconds so far. So the development team ignores such a serious mistake for now.
